
var ('sigma')
var ('gamma')
var ('beta')
var ('alpha_1')
var ('alpha_2')
var ('ss_tau')
var ('ss_T')
var ('ss_l1')
var ('ss_l2')
var ('ss_b')
var ('ss_g')
var ('ss_theta_1')
var ('ss_theta_2')
var ('tau_')
var ('T_')
var ('l1_')
var ('l2_')
var ('b_')
var ('tau')
var ('T')
var ('l1')
var ('l2')
var ('b')
var ('g')
var ('theta_1')
var ('theta_2')
var ('ss_lambda_I')
I=ss_lambda_I*( ss_g*exp(g)+2*ss_T*exp(T)+beta*ss_b*exp(b)-ss_tau*ss_l1*ss_theta_1*exp(tau+theta_1+l1)-ss_tau*ss_l2*ss_theta_2*exp(tau+theta_2+l2)-ss_b*exp(b_))
ILinearApprox= simplify((taylor(I,(tau_,0),(T_,0),(l1_,0),(l2_,0),(b_,0),(tau,0),(T,0),(l1,0),(l2,0),(b,0),(tau,0),(T,0),(l1,0),1)))
IQuadApprox== simplify((taylor(I,(tau_,0),(T_,0),(l1_,0),(l2_,0),(b_,0),(tau,0),(T,0),(l1,0),(l2,0),(b,0),(tau,0),(T,0),(l1,0),2)))-ILinearApprox
# Linear Terms
IDy = vector([ ILinearApprox.coefficient(tau) , ILinearApprox.coefficient(T) , ILinearApprox.coefficient(l1) , ILinearApprox.coefficient(l2) , ILinearApprox.coefficient(b)])
IDycheck = vector([ ILinearApprox.coefficient(tau_) , ILinearApprox.coefficient(T_) , ILinearApprox.coefficient(l1_) , ILinearApprox.coefficient(l2_) , ILinearApprox.coefficient(b_)])
IDxi = vector([ ILinearApprox.coefficient(g) , ILinearApprox.coefficient(theta_1) , ILinearApprox.coefficient(theta_2)])
# Quadratic Terms
IDyy = matrix([[ IQuadApprox.coefficient(tau^2), (IQuadApprox.coefficient(tau)/2).coefficient(T), (IQuadApprox.coefficient(tau)/2).coefficient(l1), (IQuadApprox.coefficient(tau)/2).coefficient(l2), (IQuadApprox.coefficient(tau)/2).coefficient(b)], [ (IQuadApprox.coefficient(T)/2).coefficient(tau), IQuadApprox.coefficient(T^2), (IQuadApprox.coefficient(T)/2).coefficient(l1), (IQuadApprox.coefficient(T)/2).coefficient(l2), (IQuadApprox.coefficient(T)/2).coefficient(b)], [ (IQuadApprox.coefficient(l1)/2).coefficient(tau), (IQuadApprox.coefficient(l1)/2).coefficient(T), IQuadApprox.coefficient(l1^2), (IQuadApprox.coefficient(l1)/2).coefficient(l2), (IQuadApprox.coefficient(l1)/2).coefficient(b)], [ (IQuadApprox.coefficient(l2)/2).coefficient(tau), (IQuadApprox.coefficient(l2)/2).coefficient(T), (IQuadApprox.coefficient(l2)/2).coefficient(l1), IQuadApprox.coefficient(l2^2), (IQuadApprox.coefficient(l2)/2).coefficient(b)], [ (IQuadApprox.coefficient(b)/2).coefficient(tau), (IQuadApprox.coefficient(b)/2).coefficient(T), (IQuadApprox.coefficient(b)/2).coefficient(l1), (IQuadApprox.coefficient(b)/2).coefficient(l2), IQuadApprox.coefficient(b^2)] ]) 
IDycheckycheck = matrix([[ IQuadApprox.coefficient(tau_^2), (IQuadApprox.coefficient(tau_)/2).coefficient(T_), (IQuadApprox.coefficient(tau_)/2).coefficient(l1_), (IQuadApprox.coefficient(tau_)/2).coefficient(l2_), (IQuadApprox.coefficient(tau_)/2).coefficient(b_)], [ (IQuadApprox.coefficient(T_)/2).coefficient(tau_), IQuadApprox.coefficient(T_^2), (IQuadApprox.coefficient(T_)/2).coefficient(l1_), (IQuadApprox.coefficient(T_)/2).coefficient(l2_), (IQuadApprox.coefficient(T_)/2).coefficient(b_)], [ (IQuadApprox.coefficient(l1_)/2).coefficient(tau_), (IQuadApprox.coefficient(l1_)/2).coefficient(T_), IQuadApprox.coefficient(l1_^2), (IQuadApprox.coefficient(l1_)/2).coefficient(l2_), (IQuadApprox.coefficient(l1_)/2).coefficient(b_)], [ (IQuadApprox.coefficient(l2_)/2).coefficient(tau_), (IQuadApprox.coefficient(l2_)/2).coefficient(T_), (IQuadApprox.coefficient(l2_)/2).coefficient(l1_), IQuadApprox.coefficient(l2_^2), (IQuadApprox.coefficient(l2_)/2).coefficient(b_)], [ (IQuadApprox.coefficient(b_)/2).coefficient(tau_), (IQuadApprox.coefficient(b_)/2).coefficient(T_), (IQuadApprox.coefficient(b_)/2).coefficient(l1_), (IQuadApprox.coefficient(b_)/2).coefficient(l2_), IQuadApprox.coefficient(b_^2)] ]) 
IDyycheck = matrix([[ (IQuadApprox.coefficient(tau)/2).coefficient(tau_), (IQuadApprox.coefficient(tau)/2).coefficient(T_), (IQuadApprox.coefficient(tau)/2).coefficient(l1_), (IQuadApprox.coefficient(tau)/2).coefficient(l2_), (IQuadApprox.coefficient(tau)/2).coefficient(b_)], [ (IQuadApprox.coefficient(T)/2).coefficient(tau_), (IQuadApprox.coefficient(T)/2).coefficient(T_), (IQuadApprox.coefficient(T)/2).coefficient(l1_), (IQuadApprox.coefficient(T)/2).coefficient(l2_), (IQuadApprox.coefficient(T)/2).coefficient(b_)], [ (IQuadApprox.coefficient(l1)/2).coefficient(tau_), (IQuadApprox.coefficient(l1)/2).coefficient(T_), (IQuadApprox.coefficient(l1)/2).coefficient(l1_), (IQuadApprox.coefficient(l1)/2).coefficient(l2_), (IQuadApprox.coefficient(l1)/2).coefficient(b_)], [ (IQuadApprox.coefficient(l2)/2).coefficient(tau_), (IQuadApprox.coefficient(l2)/2).coefficient(T_), (IQuadApprox.coefficient(l2)/2).coefficient(l1_), (IQuadApprox.coefficient(l2)/2).coefficient(l2_), (IQuadApprox.coefficient(l2)/2).coefficient(b_)], [ (IQuadApprox.coefficient(b)/2).coefficient(tau_), (IQuadApprox.coefficient(b)/2).coefficient(T_), (IQuadApprox.coefficient(b)/2).coefficient(l1_), (IQuadApprox.coefficient(b)/2).coefficient(l2_), (IQuadApprox.coefficient(b)/2).coefficient(b_)] ]) 
IDyxi = matrix([[ (IQuadApprox.coefficient(tau)/2).coefficient(g), (IQuadApprox.coefficient(tau)/2).coefficient(theta_1), (IQuadApprox.coefficient(tau)/2).coefficient(theta_2)], [ (IQuadApprox.coefficient(T)/2).coefficient(g), (IQuadApprox.coefficient(T)/2).coefficient(theta_1), (IQuadApprox.coefficient(T)/2).coefficient(theta_2)], [ (IQuadApprox.coefficient(l1)/2).coefficient(g), (IQuadApprox.coefficient(l1)/2).coefficient(theta_1), (IQuadApprox.coefficient(l1)/2).coefficient(theta_2)], [ (IQuadApprox.coefficient(l2)/2).coefficient(g), (IQuadApprox.coefficient(l2)/2).coefficient(theta_1), (IQuadApprox.coefficient(l2)/2).coefficient(theta_2)], [ (IQuadApprox.coefficient(b)/2).coefficient(g), (IQuadApprox.coefficient(b)/2).coefficient(theta_1), (IQuadApprox.coefficient(b)/2).coefficient(theta_2)] ]) 
IDycheckxi= matrix([[ (IQuadApprox.coefficient(tau_)/2).coefficient(g), (IQuadApprox.coefficient(tau_)/2).coefficient(theta_1), (IQuadApprox.coefficient(tau_)/2).coefficient(theta_2)], [ (IQuadApprox.coefficient(T_)/2).coefficient(g), (IQuadApprox.coefficient(T_)/2).coefficient(theta_1), (IQuadApprox.coefficient(T_)/2).coefficient(theta_2)], [ (IQuadApprox.coefficient(l1_)/2).coefficient(g), (IQuadApprox.coefficient(l1_)/2).coefficient(theta_1), (IQuadApprox.coefficient(l1_)/2).coefficient(theta_2)], [ (IQuadApprox.coefficient(l2_)/2).coefficient(g), (IQuadApprox.coefficient(l2_)/2).coefficient(theta_1), (IQuadApprox.coefficient(l2_)/2).coefficient(theta_2)], [ (IQuadApprox.coefficient(b_)/2).coefficient(g), (IQuadApprox.coefficient(b_)/2).coefficient(theta_1), (IQuadApprox.coefficient(b_)/2).coefficient(theta_2)] ]) 
IDxixi = matrix([[ IQuadApprox.coefficient(g^2), (IQuadApprox.coefficient(g)/2).coefficient(theta_1), (IQuadApprox.coefficient(g)/2).coefficient(theta_2)], [ (IQuadApprox.coefficient(theta_1)/2).coefficient(g), IQuadApprox.coefficient(theta_1^2), (IQuadApprox.coefficient(theta_1)/2).coefficient(theta_2)], [ (IQuadApprox.coefficient(theta_2)/2).coefficient(g), (IQuadApprox.coefficient(theta_2)/2).coefficient(theta_1), IQuadApprox.coefficient(theta_2^2)] ]) 


var ('ss_lambda_R')
R=ss_lambda_R*( (ss_theta_1*exp(theta_1))^(1/sigma) *(1-ss_tau*exp(tau))^(1/sigma)*(ss_l1*exp(l1))^(-gamma/sigma) + (ss_theta_2*exp(theta_2))^(1/sigma) *(1-ss_tau*exp(tau))^(1/sigma)*(ss_l2*exp(l2))^(-gamma/sigma) + ss_g*exp(g)-ss_theta_1*ss_l1*exp(theta_1+l1)-ss_theta_2*ss_l2*exp(theta_2+l2)  )
RLinearApprox= simplify((taylor(R,(tau_,0),(T_,0),(l1_,0),(l2_,0),(b_,0),(tau,0),(T,0),(l1,0),(l2,0),(b,0),(tau,0),(T,0),(l1,0),1)))
RQuadApprox== simplify((taylor(R,(tau_,0),(T_,0),(l1_,0),(l2_,0),(b_,0),(tau,0),(T,0),(l1,0),(l2,0),(b,0),(tau,0),(T,0),(l1,0),2)))-RLinearApprox
# Linear Terms
RDy = vector([ RLinearApprox.coefficient(tau) , RLinearApprox.coefficient(T) , RLinearApprox.coefficient(l1) , RLinearApprox.coefficient(l2) , RLinearApprox.coefficient(b)])
RDycheck = vector([ RLinearApprox.coefficient(tau_) , RLinearApprox.coefficient(T_) , RLinearApprox.coefficient(l1_) , RLinearApprox.coefficient(l2_) , RLinearApprox.coefficient(b_)])
RDxi = vector([ RLinearApprox.coefficient(g) , RLinearApprox.coefficient(theta_1) , RLinearApprox.coefficient(theta_2)])
# Quadratic Terms
RDyy = matrix([[ RQuadApprox.coefficient(tau^2), (RQuadApprox.coefficient(tau)/2).coefficient(T), (RQuadApprox.coefficient(tau)/2).coefficient(l1), (RQuadApprox.coefficient(tau)/2).coefficient(l2), (RQuadApprox.coefficient(tau)/2).coefficient(b)], [ (RQuadApprox.coefficient(T)/2).coefficient(tau), RQuadApprox.coefficient(T^2), (RQuadApprox.coefficient(T)/2).coefficient(l1), (RQuadApprox.coefficient(T)/2).coefficient(l2), (RQuadApprox.coefficient(T)/2).coefficient(b)], [ (RQuadApprox.coefficient(l1)/2).coefficient(tau), (RQuadApprox.coefficient(l1)/2).coefficient(T), RQuadApprox.coefficient(l1^2), (RQuadApprox.coefficient(l1)/2).coefficient(l2), (RQuadApprox.coefficient(l1)/2).coefficient(b)], [ (RQuadApprox.coefficient(l2)/2).coefficient(tau), (RQuadApprox.coefficient(l2)/2).coefficient(T), (RQuadApprox.coefficient(l2)/2).coefficient(l1), RQuadApprox.coefficient(l2^2), (RQuadApprox.coefficient(l2)/2).coefficient(b)], [ (RQuadApprox.coefficient(b)/2).coefficient(tau), (RQuadApprox.coefficient(b)/2).coefficient(T), (RQuadApprox.coefficient(b)/2).coefficient(l1), (RQuadApprox.coefficient(b)/2).coefficient(l2), RQuadApprox.coefficient(b^2)] ]) 
RDycheckycheck = matrix([[ RQuadApprox.coefficient(tau_^2), (RQuadApprox.coefficient(tau_)/2).coefficient(T_), (RQuadApprox.coefficient(tau_)/2).coefficient(l1_), (RQuadApprox.coefficient(tau_)/2).coefficient(l2_), (RQuadApprox.coefficient(tau_)/2).coefficient(b_)], [ (RQuadApprox.coefficient(T_)/2).coefficient(tau_), RQuadApprox.coefficient(T_^2), (RQuadApprox.coefficient(T_)/2).coefficient(l1_), (RQuadApprox.coefficient(T_)/2).coefficient(l2_), (RQuadApprox.coefficient(T_)/2).coefficient(b_)], [ (RQuadApprox.coefficient(l1_)/2).coefficient(tau_), (RQuadApprox.coefficient(l1_)/2).coefficient(T_), RQuadApprox.coefficient(l1_^2), (RQuadApprox.coefficient(l1_)/2).coefficient(l2_), (RQuadApprox.coefficient(l1_)/2).coefficient(b_)], [ (RQuadApprox.coefficient(l2_)/2).coefficient(tau_), (RQuadApprox.coefficient(l2_)/2).coefficient(T_), (RQuadApprox.coefficient(l2_)/2).coefficient(l1_), RQuadApprox.coefficient(l2_^2), (RQuadApprox.coefficient(l2_)/2).coefficient(b_)], [ (RQuadApprox.coefficient(b_)/2).coefficient(tau_), (RQuadApprox.coefficient(b_)/2).coefficient(T_), (RQuadApprox.coefficient(b_)/2).coefficient(l1_), (RQuadApprox.coefficient(b_)/2).coefficient(l2_), RQuadApprox.coefficient(b_^2)] ]) 
RDyycheck = matrix([[ (RQuadApprox.coefficient(tau)/2).coefficient(tau_), (RQuadApprox.coefficient(tau)/2).coefficient(T_), (RQuadApprox.coefficient(tau)/2).coefficient(l1_), (RQuadApprox.coefficient(tau)/2).coefficient(l2_), (RQuadApprox.coefficient(tau)/2).coefficient(b_)], [ (RQuadApprox.coefficient(T)/2).coefficient(tau_), (RQuadApprox.coefficient(T)/2).coefficient(T_), (RQuadApprox.coefficient(T)/2).coefficient(l1_), (RQuadApprox.coefficient(T)/2).coefficient(l2_), (RQuadApprox.coefficient(T)/2).coefficient(b_)], [ (RQuadApprox.coefficient(l1)/2).coefficient(tau_), (RQuadApprox.coefficient(l1)/2).coefficient(T_), (RQuadApprox.coefficient(l1)/2).coefficient(l1_), (RQuadApprox.coefficient(l1)/2).coefficient(l2_), (RQuadApprox.coefficient(l1)/2).coefficient(b_)], [ (RQuadApprox.coefficient(l2)/2).coefficient(tau_), (RQuadApprox.coefficient(l2)/2).coefficient(T_), (RQuadApprox.coefficient(l2)/2).coefficient(l1_), (RQuadApprox.coefficient(l2)/2).coefficient(l2_), (RQuadApprox.coefficient(l2)/2).coefficient(b_)], [ (RQuadApprox.coefficient(b)/2).coefficient(tau_), (RQuadApprox.coefficient(b)/2).coefficient(T_), (RQuadApprox.coefficient(b)/2).coefficient(l1_), (RQuadApprox.coefficient(b)/2).coefficient(l2_), (RQuadApprox.coefficient(b)/2).coefficient(b_)] ]) 
RDyxi = matrix([[ (RQuadApprox.coefficient(tau)/2).coefficient(g), (RQuadApprox.coefficient(tau)/2).coefficient(theta_1), (RQuadApprox.coefficient(tau)/2).coefficient(theta_2)], [ (RQuadApprox.coefficient(T)/2).coefficient(g), (RQuadApprox.coefficient(T)/2).coefficient(theta_1), (RQuadApprox.coefficient(T)/2).coefficient(theta_2)], [ (RQuadApprox.coefficient(l1)/2).coefficient(g), (RQuadApprox.coefficient(l1)/2).coefficient(theta_1), (RQuadApprox.coefficient(l1)/2).coefficient(theta_2)], [ (RQuadApprox.coefficient(l2)/2).coefficient(g), (RQuadApprox.coefficient(l2)/2).coefficient(theta_1), (RQuadApprox.coefficient(l2)/2).coefficient(theta_2)], [ (RQuadApprox.coefficient(b)/2).coefficient(g), (RQuadApprox.coefficient(b)/2).coefficient(theta_1), (RQuadApprox.coefficient(b)/2).coefficient(theta_2)] ]) 
RDycheckxi= matrix([[ (RQuadApprox.coefficient(tau_)/2).coefficient(g), (RQuadApprox.coefficient(tau_)/2).coefficient(theta_1), (RQuadApprox.coefficient(tau_)/2).coefficient(theta_2)], [ (RQuadApprox.coefficient(T_)/2).coefficient(g), (RQuadApprox.coefficient(T_)/2).coefficient(theta_1), (RQuadApprox.coefficient(T_)/2).coefficient(theta_2)], [ (RQuadApprox.coefficient(l1_)/2).coefficient(g), (RQuadApprox.coefficient(l1_)/2).coefficient(theta_1), (RQuadApprox.coefficient(l1_)/2).coefficient(theta_2)], [ (RQuadApprox.coefficient(l2_)/2).coefficient(g), (RQuadApprox.coefficient(l2_)/2).coefficient(theta_1), (RQuadApprox.coefficient(l2_)/2).coefficient(theta_2)], [ (RQuadApprox.coefficient(b_)/2).coefficient(g), (RQuadApprox.coefficient(b_)/2).coefficient(theta_1), (RQuadApprox.coefficient(b_)/2).coefficient(theta_2)] ]) 
RDxixi = matrix([[ RQuadApprox.coefficient(g^2), (RQuadApprox.coefficient(g)/2).coefficient(theta_1), (RQuadApprox.coefficient(g)/2).coefficient(theta_2)], [ (RQuadApprox.coefficient(theta_1)/2).coefficient(g), RQuadApprox.coefficient(theta_1^2), (RQuadApprox.coefficient(theta_1)/2).coefficient(theta_2)], [ (RQuadApprox.coefficient(theta_2)/2).coefficient(g), (RQuadApprox.coefficient(theta_2)/2).coefficient(theta_1), RQuadApprox.coefficient(theta_2^2)] ]) 


var ('ss_lambda_B2')
B2=ss_lambda_B2*( (ss_theta_2*exp(theta_2))^(1/sigma) *(1-ss_tau*exp(tau))^(1/sigma)*(ss_l2*exp(l2))^(-gamma/sigma)-ss_T*exp(T)-ss_theta_1*ss_l2*exp(theta_2+l2)*(1-ss_tau*exp(tau)))
B2LinearApprox= simplify((taylor(B2,(tau_,0),(T_,0),(l1_,0),(l2_,0),(b_,0),(tau,0),(T,0),(l1,0),(l2,0),(b,0),(tau,0),(T,0),(l1,0),1)))
B2QuadApprox== simplify((taylor(B2,(tau_,0),(T_,0),(l1_,0),(l2_,0),(b_,0),(tau,0),(T,0),(l1,0),(l2,0),(b,0),(tau,0),(T,0),(l1,0),2)))-B2LinearApprox
# Linear Terms
B2Dy = vector([ B2LinearApprox.coefficient(tau) , B2LinearApprox.coefficient(T) , B2LinearApprox.coefficient(l1) , B2LinearApprox.coefficient(l2) , B2LinearApprox.coefficient(b)])
B2Dycheck = vector([ B2LinearApprox.coefficient(tau_) , B2LinearApprox.coefficient(T_) , B2LinearApprox.coefficient(l1_) , B2LinearApprox.coefficient(l2_) , B2LinearApprox.coefficient(b_)])
B2Dxi = vector([ B2LinearApprox.coefficient(g) , B2LinearApprox.coefficient(theta_1) , B2LinearApprox.coefficient(theta_2)])
# Quadratic Terms
B2Dyy = matrix([[ B2QuadApprox.coefficient(tau^2), (B2QuadApprox.coefficient(tau)/2).coefficient(T), (B2QuadApprox.coefficient(tau)/2).coefficient(l1), (B2QuadApprox.coefficient(tau)/2).coefficient(l2), (B2QuadApprox.coefficient(tau)/2).coefficient(b)], [ (B2QuadApprox.coefficient(T)/2).coefficient(tau), B2QuadApprox.coefficient(T^2), (B2QuadApprox.coefficient(T)/2).coefficient(l1), (B2QuadApprox.coefficient(T)/2).coefficient(l2), (B2QuadApprox.coefficient(T)/2).coefficient(b)], [ (B2QuadApprox.coefficient(l1)/2).coefficient(tau), (B2QuadApprox.coefficient(l1)/2).coefficient(T), B2QuadApprox.coefficient(l1^2), (B2QuadApprox.coefficient(l1)/2).coefficient(l2), (B2QuadApprox.coefficient(l1)/2).coefficient(b)], [ (B2QuadApprox.coefficient(l2)/2).coefficient(tau), (B2QuadApprox.coefficient(l2)/2).coefficient(T), (B2QuadApprox.coefficient(l2)/2).coefficient(l1), B2QuadApprox.coefficient(l2^2), (B2QuadApprox.coefficient(l2)/2).coefficient(b)], [ (B2QuadApprox.coefficient(b)/2).coefficient(tau), (B2QuadApprox.coefficient(b)/2).coefficient(T), (B2QuadApprox.coefficient(b)/2).coefficient(l1), (B2QuadApprox.coefficient(b)/2).coefficient(l2), B2QuadApprox.coefficient(b^2)] ]) 
B2Dycheckycheck = matrix([[ B2QuadApprox.coefficient(tau_^2), (B2QuadApprox.coefficient(tau_)/2).coefficient(T_), (B2QuadApprox.coefficient(tau_)/2).coefficient(l1_), (B2QuadApprox.coefficient(tau_)/2).coefficient(l2_), (B2QuadApprox.coefficient(tau_)/2).coefficient(b_)], [ (B2QuadApprox.coefficient(T_)/2).coefficient(tau_), B2QuadApprox.coefficient(T_^2), (B2QuadApprox.coefficient(T_)/2).coefficient(l1_), (B2QuadApprox.coefficient(T_)/2).coefficient(l2_), (B2QuadApprox.coefficient(T_)/2).coefficient(b_)], [ (B2QuadApprox.coefficient(l1_)/2).coefficient(tau_), (B2QuadApprox.coefficient(l1_)/2).coefficient(T_), B2QuadApprox.coefficient(l1_^2), (B2QuadApprox.coefficient(l1_)/2).coefficient(l2_), (B2QuadApprox.coefficient(l1_)/2).coefficient(b_)], [ (B2QuadApprox.coefficient(l2_)/2).coefficient(tau_), (B2QuadApprox.coefficient(l2_)/2).coefficient(T_), (B2QuadApprox.coefficient(l2_)/2).coefficient(l1_), B2QuadApprox.coefficient(l2_^2), (B2QuadApprox.coefficient(l2_)/2).coefficient(b_)], [ (B2QuadApprox.coefficient(b_)/2).coefficient(tau_), (B2QuadApprox.coefficient(b_)/2).coefficient(T_), (B2QuadApprox.coefficient(b_)/2).coefficient(l1_), (B2QuadApprox.coefficient(b_)/2).coefficient(l2_), B2QuadApprox.coefficient(b_^2)] ]) 
B2Dyycheck = matrix([[ (B2QuadApprox.coefficient(tau)/2).coefficient(tau_), (B2QuadApprox.coefficient(tau)/2).coefficient(T_), (B2QuadApprox.coefficient(tau)/2).coefficient(l1_), (B2QuadApprox.coefficient(tau)/2).coefficient(l2_), (B2QuadApprox.coefficient(tau)/2).coefficient(b_)], [ (B2QuadApprox.coefficient(T)/2).coefficient(tau_), (B2QuadApprox.coefficient(T)/2).coefficient(T_), (B2QuadApprox.coefficient(T)/2).coefficient(l1_), (B2QuadApprox.coefficient(T)/2).coefficient(l2_), (B2QuadApprox.coefficient(T)/2).coefficient(b_)], [ (B2QuadApprox.coefficient(l1)/2).coefficient(tau_), (B2QuadApprox.coefficient(l1)/2).coefficient(T_), (B2QuadApprox.coefficient(l1)/2).coefficient(l1_), (B2QuadApprox.coefficient(l1)/2).coefficient(l2_), (B2QuadApprox.coefficient(l1)/2).coefficient(b_)], [ (B2QuadApprox.coefficient(l2)/2).coefficient(tau_), (B2QuadApprox.coefficient(l2)/2).coefficient(T_), (B2QuadApprox.coefficient(l2)/2).coefficient(l1_), (B2QuadApprox.coefficient(l2)/2).coefficient(l2_), (B2QuadApprox.coefficient(l2)/2).coefficient(b_)], [ (B2QuadApprox.coefficient(b)/2).coefficient(tau_), (B2QuadApprox.coefficient(b)/2).coefficient(T_), (B2QuadApprox.coefficient(b)/2).coefficient(l1_), (B2QuadApprox.coefficient(b)/2).coefficient(l2_), (B2QuadApprox.coefficient(b)/2).coefficient(b_)] ]) 
B2Dyxi = matrix([[ (B2QuadApprox.coefficient(tau)/2).coefficient(g), (B2QuadApprox.coefficient(tau)/2).coefficient(theta_1), (B2QuadApprox.coefficient(tau)/2).coefficient(theta_2)], [ (B2QuadApprox.coefficient(T)/2).coefficient(g), (B2QuadApprox.coefficient(T)/2).coefficient(theta_1), (B2QuadApprox.coefficient(T)/2).coefficient(theta_2)], [ (B2QuadApprox.coefficient(l1)/2).coefficient(g), (B2QuadApprox.coefficient(l1)/2).coefficient(theta_1), (B2QuadApprox.coefficient(l1)/2).coefficient(theta_2)], [ (B2QuadApprox.coefficient(l2)/2).coefficient(g), (B2QuadApprox.coefficient(l2)/2).coefficient(theta_1), (B2QuadApprox.coefficient(l2)/2).coefficient(theta_2)], [ (B2QuadApprox.coefficient(b)/2).coefficient(g), (B2QuadApprox.coefficient(b)/2).coefficient(theta_1), (B2QuadApprox.coefficient(b)/2).coefficient(theta_2)] ]) 
B2Dycheckxi= matrix([[ (B2QuadApprox.coefficient(tau_)/2).coefficient(g), (B2QuadApprox.coefficient(tau_)/2).coefficient(theta_1), (B2QuadApprox.coefficient(tau_)/2).coefficient(theta_2)], [ (B2QuadApprox.coefficient(T_)/2).coefficient(g), (B2QuadApprox.coefficient(T_)/2).coefficient(theta_1), (B2QuadApprox.coefficient(T_)/2).coefficient(theta_2)], [ (B2QuadApprox.coefficient(l1_)/2).coefficient(g), (B2QuadApprox.coefficient(l1_)/2).coefficient(theta_1), (B2QuadApprox.coefficient(l1_)/2).coefficient(theta_2)], [ (B2QuadApprox.coefficient(l2_)/2).coefficient(g), (B2QuadApprox.coefficient(l2_)/2).coefficient(theta_1), (B2QuadApprox.coefficient(l2_)/2).coefficient(theta_2)], [ (B2QuadApprox.coefficient(b_)/2).coefficient(g), (B2QuadApprox.coefficient(b_)/2).coefficient(theta_1), (B2QuadApprox.coefficient(b_)/2).coefficient(theta_2)] ]) 
B2Dxixi = matrix([[ B2QuadApprox.coefficient(g^2), (B2QuadApprox.coefficient(g)/2).coefficient(theta_1), (B2QuadApprox.coefficient(g)/2).coefficient(theta_2)], [ (B2QuadApprox.coefficient(theta_1)/2).coefficient(g), B2QuadApprox.coefficient(theta_1^2), (B2QuadApprox.coefficient(theta_1)/2).coefficient(theta_2)], [ (B2QuadApprox.coefficient(theta_2)/2).coefficient(g), (B2QuadApprox.coefficient(theta_2)/2).coefficient(theta_1), B2QuadApprox.coefficient(theta_2^2)] ]) 


var ('ss_lambda_E1')
E1=ss_lambda_E1*( ss_l1*exp(gamma*l1)*(1-ss_tau*exp(tau_))-ss_l1*exp(gamma*l1_)*(1-ss_tau*exp(tau)))
E1LinearApprox= simplify((taylor(E1,(tau_,0),(T_,0),(l1_,0),(l2_,0),(b_,0),(tau,0),(T,0),(l1,0),(l2,0),(b,0),(tau,0),(T,0),(l1,0),1)))
E1QuadApprox== simplify((taylor(E1,(tau_,0),(T_,0),(l1_,0),(l2_,0),(b_,0),(tau,0),(T,0),(l1,0),(l2,0),(b,0),(tau,0),(T,0),(l1,0),2)))-E1LinearApprox
# Linear Terms
E1Dy = vector([ E1LinearApprox.coefficient(tau) , E1LinearApprox.coefficient(T) , E1LinearApprox.coefficient(l1) , E1LinearApprox.coefficient(l2) , E1LinearApprox.coefficient(b)])
E1Dycheck = vector([ E1LinearApprox.coefficient(tau_) , E1LinearApprox.coefficient(T_) , E1LinearApprox.coefficient(l1_) , E1LinearApprox.coefficient(l2_) , E1LinearApprox.coefficient(b_)])
E1Dxi = vector([ E1LinearApprox.coefficient(g) , E1LinearApprox.coefficient(theta_1) , E1LinearApprox.coefficient(theta_2)])
# Quadratic Terms
E1Dyy = matrix([[ E1QuadApprox.coefficient(tau^2), (E1QuadApprox.coefficient(tau)/2).coefficient(T), (E1QuadApprox.coefficient(tau)/2).coefficient(l1), (E1QuadApprox.coefficient(tau)/2).coefficient(l2), (E1QuadApprox.coefficient(tau)/2).coefficient(b)], [ (E1QuadApprox.coefficient(T)/2).coefficient(tau), E1QuadApprox.coefficient(T^2), (E1QuadApprox.coefficient(T)/2).coefficient(l1), (E1QuadApprox.coefficient(T)/2).coefficient(l2), (E1QuadApprox.coefficient(T)/2).coefficient(b)], [ (E1QuadApprox.coefficient(l1)/2).coefficient(tau), (E1QuadApprox.coefficient(l1)/2).coefficient(T), E1QuadApprox.coefficient(l1^2), (E1QuadApprox.coefficient(l1)/2).coefficient(l2), (E1QuadApprox.coefficient(l1)/2).coefficient(b)], [ (E1QuadApprox.coefficient(l2)/2).coefficient(tau), (E1QuadApprox.coefficient(l2)/2).coefficient(T), (E1QuadApprox.coefficient(l2)/2).coefficient(l1), E1QuadApprox.coefficient(l2^2), (E1QuadApprox.coefficient(l2)/2).coefficient(b)], [ (E1QuadApprox.coefficient(b)/2).coefficient(tau), (E1QuadApprox.coefficient(b)/2).coefficient(T), (E1QuadApprox.coefficient(b)/2).coefficient(l1), (E1QuadApprox.coefficient(b)/2).coefficient(l2), E1QuadApprox.coefficient(b^2)] ]) 
E1Dycheckycheck = matrix([[ E1QuadApprox.coefficient(tau_^2), (E1QuadApprox.coefficient(tau_)/2).coefficient(T_), (E1QuadApprox.coefficient(tau_)/2).coefficient(l1_), (E1QuadApprox.coefficient(tau_)/2).coefficient(l2_), (E1QuadApprox.coefficient(tau_)/2).coefficient(b_)], [ (E1QuadApprox.coefficient(T_)/2).coefficient(tau_), E1QuadApprox.coefficient(T_^2), (E1QuadApprox.coefficient(T_)/2).coefficient(l1_), (E1QuadApprox.coefficient(T_)/2).coefficient(l2_), (E1QuadApprox.coefficient(T_)/2).coefficient(b_)], [ (E1QuadApprox.coefficient(l1_)/2).coefficient(tau_), (E1QuadApprox.coefficient(l1_)/2).coefficient(T_), E1QuadApprox.coefficient(l1_^2), (E1QuadApprox.coefficient(l1_)/2).coefficient(l2_), (E1QuadApprox.coefficient(l1_)/2).coefficient(b_)], [ (E1QuadApprox.coefficient(l2_)/2).coefficient(tau_), (E1QuadApprox.coefficient(l2_)/2).coefficient(T_), (E1QuadApprox.coefficient(l2_)/2).coefficient(l1_), E1QuadApprox.coefficient(l2_^2), (E1QuadApprox.coefficient(l2_)/2).coefficient(b_)], [ (E1QuadApprox.coefficient(b_)/2).coefficient(tau_), (E1QuadApprox.coefficient(b_)/2).coefficient(T_), (E1QuadApprox.coefficient(b_)/2).coefficient(l1_), (E1QuadApprox.coefficient(b_)/2).coefficient(l2_), E1QuadApprox.coefficient(b_^2)] ]) 
E1Dyycheck = matrix([[ (E1QuadApprox.coefficient(tau)/2).coefficient(tau_), (E1QuadApprox.coefficient(tau)/2).coefficient(T_), (E1QuadApprox.coefficient(tau)/2).coefficient(l1_), (E1QuadApprox.coefficient(tau)/2).coefficient(l2_), (E1QuadApprox.coefficient(tau)/2).coefficient(b_)], [ (E1QuadApprox.coefficient(T)/2).coefficient(tau_), (E1QuadApprox.coefficient(T)/2).coefficient(T_), (E1QuadApprox.coefficient(T)/2).coefficient(l1_), (E1QuadApprox.coefficient(T)/2).coefficient(l2_), (E1QuadApprox.coefficient(T)/2).coefficient(b_)], [ (E1QuadApprox.coefficient(l1)/2).coefficient(tau_), (E1QuadApprox.coefficient(l1)/2).coefficient(T_), (E1QuadApprox.coefficient(l1)/2).coefficient(l1_), (E1QuadApprox.coefficient(l1)/2).coefficient(l2_), (E1QuadApprox.coefficient(l1)/2).coefficient(b_)], [ (E1QuadApprox.coefficient(l2)/2).coefficient(tau_), (E1QuadApprox.coefficient(l2)/2).coefficient(T_), (E1QuadApprox.coefficient(l2)/2).coefficient(l1_), (E1QuadApprox.coefficient(l2)/2).coefficient(l2_), (E1QuadApprox.coefficient(l2)/2).coefficient(b_)], [ (E1QuadApprox.coefficient(b)/2).coefficient(tau_), (E1QuadApprox.coefficient(b)/2).coefficient(T_), (E1QuadApprox.coefficient(b)/2).coefficient(l1_), (E1QuadApprox.coefficient(b)/2).coefficient(l2_), (E1QuadApprox.coefficient(b)/2).coefficient(b_)] ]) 
E1Dyxi = matrix([[ (E1QuadApprox.coefficient(tau)/2).coefficient(g), (E1QuadApprox.coefficient(tau)/2).coefficient(theta_1), (E1QuadApprox.coefficient(tau)/2).coefficient(theta_2)], [ (E1QuadApprox.coefficient(T)/2).coefficient(g), (E1QuadApprox.coefficient(T)/2).coefficient(theta_1), (E1QuadApprox.coefficient(T)/2).coefficient(theta_2)], [ (E1QuadApprox.coefficient(l1)/2).coefficient(g), (E1QuadApprox.coefficient(l1)/2).coefficient(theta_1), (E1QuadApprox.coefficient(l1)/2).coefficient(theta_2)], [ (E1QuadApprox.coefficient(l2)/2).coefficient(g), (E1QuadApprox.coefficient(l2)/2).coefficient(theta_1), (E1QuadApprox.coefficient(l2)/2).coefficient(theta_2)], [ (E1QuadApprox.coefficient(b)/2).coefficient(g), (E1QuadApprox.coefficient(b)/2).coefficient(theta_1), (E1QuadApprox.coefficient(b)/2).coefficient(theta_2)] ]) 
E1Dycheckxi= matrix([[ (E1QuadApprox.coefficient(tau_)/2).coefficient(g), (E1QuadApprox.coefficient(tau_)/2).coefficient(theta_1), (E1QuadApprox.coefficient(tau_)/2).coefficient(theta_2)], [ (E1QuadApprox.coefficient(T_)/2).coefficient(g), (E1QuadApprox.coefficient(T_)/2).coefficient(theta_1), (E1QuadApprox.coefficient(T_)/2).coefficient(theta_2)], [ (E1QuadApprox.coefficient(l1_)/2).coefficient(g), (E1QuadApprox.coefficient(l1_)/2).coefficient(theta_1), (E1QuadApprox.coefficient(l1_)/2).coefficient(theta_2)], [ (E1QuadApprox.coefficient(l2_)/2).coefficient(g), (E1QuadApprox.coefficient(l2_)/2).coefficient(theta_1), (E1QuadApprox.coefficient(l2_)/2).coefficient(theta_2)], [ (E1QuadApprox.coefficient(b_)/2).coefficient(g), (E1QuadApprox.coefficient(b_)/2).coefficient(theta_1), (E1QuadApprox.coefficient(b_)/2).coefficient(theta_2)] ]) 
E1Dxixi = matrix([[ E1QuadApprox.coefficient(g^2), (E1QuadApprox.coefficient(g)/2).coefficient(theta_1), (E1QuadApprox.coefficient(g)/2).coefficient(theta_2)], [ (E1QuadApprox.coefficient(theta_1)/2).coefficient(g), E1QuadApprox.coefficient(theta_1^2), (E1QuadApprox.coefficient(theta_1)/2).coefficient(theta_2)], [ (E1QuadApprox.coefficient(theta_2)/2).coefficient(g), (E1QuadApprox.coefficient(theta_2)/2).coefficient(theta_1), E1QuadApprox.coefficient(theta_2^2)] ]) 


var ('ss_lambda_E2')
E2=ss_lambda_E2*( ss_l2*exp(gamma*l2)*(1-ss_tau*exp(tau_))-ss_l2*exp(gamma*l2_)*(1-ss_tau*exp(tau)))
E2LinearApprox= simplify((taylor(E2,(tau_,0),(T_,0),(l1_,0),(l2_,0),(b_,0),(tau,0),(T,0),(l1,0),(l2,0),(b,0),(tau,0),(T,0),(l1,0),1)))
E2QuadApprox== simplify((taylor(E2,(tau_,0),(T_,0),(l1_,0),(l2_,0),(b_,0),(tau,0),(T,0),(l1,0),(l2,0),(b,0),(tau,0),(T,0),(l1,0),2)))-E2LinearApprox
# Linear Terms
E2Dy = vector([ E2LinearApprox.coefficient(tau) , E2LinearApprox.coefficient(T) , E2LinearApprox.coefficient(l1) , E2LinearApprox.coefficient(l2) , E2LinearApprox.coefficient(b)])
E2Dycheck = vector([ E2LinearApprox.coefficient(tau_) , E2LinearApprox.coefficient(T_) , E2LinearApprox.coefficient(l1_) , E2LinearApprox.coefficient(l2_) , E2LinearApprox.coefficient(b_)])
E2Dxi = vector([ E2LinearApprox.coefficient(g) , E2LinearApprox.coefficient(theta_1) , E2LinearApprox.coefficient(theta_2)])
# Quadratic Terms
E2Dyy = matrix([[ E2QuadApprox.coefficient(tau^2), (E2QuadApprox.coefficient(tau)/2).coefficient(T), (E2QuadApprox.coefficient(tau)/2).coefficient(l1), (E2QuadApprox.coefficient(tau)/2).coefficient(l2), (E2QuadApprox.coefficient(tau)/2).coefficient(b)], [ (E2QuadApprox.coefficient(T)/2).coefficient(tau), E2QuadApprox.coefficient(T^2), (E2QuadApprox.coefficient(T)/2).coefficient(l1), (E2QuadApprox.coefficient(T)/2).coefficient(l2), (E2QuadApprox.coefficient(T)/2).coefficient(b)], [ (E2QuadApprox.coefficient(l1)/2).coefficient(tau), (E2QuadApprox.coefficient(l1)/2).coefficient(T), E2QuadApprox.coefficient(l1^2), (E2QuadApprox.coefficient(l1)/2).coefficient(l2), (E2QuadApprox.coefficient(l1)/2).coefficient(b)], [ (E2QuadApprox.coefficient(l2)/2).coefficient(tau), (E2QuadApprox.coefficient(l2)/2).coefficient(T), (E2QuadApprox.coefficient(l2)/2).coefficient(l1), E2QuadApprox.coefficient(l2^2), (E2QuadApprox.coefficient(l2)/2).coefficient(b)], [ (E2QuadApprox.coefficient(b)/2).coefficient(tau), (E2QuadApprox.coefficient(b)/2).coefficient(T), (E2QuadApprox.coefficient(b)/2).coefficient(l1), (E2QuadApprox.coefficient(b)/2).coefficient(l2), E2QuadApprox.coefficient(b^2)] ]) 
E2Dycheckycheck = matrix([[ E2QuadApprox.coefficient(tau_^2), (E2QuadApprox.coefficient(tau_)/2).coefficient(T_), (E2QuadApprox.coefficient(tau_)/2).coefficient(l1_), (E2QuadApprox.coefficient(tau_)/2).coefficient(l2_), (E2QuadApprox.coefficient(tau_)/2).coefficient(b_)], [ (E2QuadApprox.coefficient(T_)/2).coefficient(tau_), E2QuadApprox.coefficient(T_^2), (E2QuadApprox.coefficient(T_)/2).coefficient(l1_), (E2QuadApprox.coefficient(T_)/2).coefficient(l2_), (E2QuadApprox.coefficient(T_)/2).coefficient(b_)], [ (E2QuadApprox.coefficient(l1_)/2).coefficient(tau_), (E2QuadApprox.coefficient(l1_)/2).coefficient(T_), E2QuadApprox.coefficient(l1_^2), (E2QuadApprox.coefficient(l1_)/2).coefficient(l2_), (E2QuadApprox.coefficient(l1_)/2).coefficient(b_)], [ (E2QuadApprox.coefficient(l2_)/2).coefficient(tau_), (E2QuadApprox.coefficient(l2_)/2).coefficient(T_), (E2QuadApprox.coefficient(l2_)/2).coefficient(l1_), E2QuadApprox.coefficient(l2_^2), (E2QuadApprox.coefficient(l2_)/2).coefficient(b_)], [ (E2QuadApprox.coefficient(b_)/2).coefficient(tau_), (E2QuadApprox.coefficient(b_)/2).coefficient(T_), (E2QuadApprox.coefficient(b_)/2).coefficient(l1_), (E2QuadApprox.coefficient(b_)/2).coefficient(l2_), E2QuadApprox.coefficient(b_^2)] ]) 
E2Dyycheck = matrix([[ (E2QuadApprox.coefficient(tau)/2).coefficient(tau_), (E2QuadApprox.coefficient(tau)/2).coefficient(T_), (E2QuadApprox.coefficient(tau)/2).coefficient(l1_), (E2QuadApprox.coefficient(tau)/2).coefficient(l2_), (E2QuadApprox.coefficient(tau)/2).coefficient(b_)], [ (E2QuadApprox.coefficient(T)/2).coefficient(tau_), (E2QuadApprox.coefficient(T)/2).coefficient(T_), (E2QuadApprox.coefficient(T)/2).coefficient(l1_), (E2QuadApprox.coefficient(T)/2).coefficient(l2_), (E2QuadApprox.coefficient(T)/2).coefficient(b_)], [ (E2QuadApprox.coefficient(l1)/2).coefficient(tau_), (E2QuadApprox.coefficient(l1)/2).coefficient(T_), (E2QuadApprox.coefficient(l1)/2).coefficient(l1_), (E2QuadApprox.coefficient(l1)/2).coefficient(l2_), (E2QuadApprox.coefficient(l1)/2).coefficient(b_)], [ (E2QuadApprox.coefficient(l2)/2).coefficient(tau_), (E2QuadApprox.coefficient(l2)/2).coefficient(T_), (E2QuadApprox.coefficient(l2)/2).coefficient(l1_), (E2QuadApprox.coefficient(l2)/2).coefficient(l2_), (E2QuadApprox.coefficient(l2)/2).coefficient(b_)], [ (E2QuadApprox.coefficient(b)/2).coefficient(tau_), (E2QuadApprox.coefficient(b)/2).coefficient(T_), (E2QuadApprox.coefficient(b)/2).coefficient(l1_), (E2QuadApprox.coefficient(b)/2).coefficient(l2_), (E2QuadApprox.coefficient(b)/2).coefficient(b_)] ]) 
E2Dyxi = matrix([[ (E2QuadApprox.coefficient(tau)/2).coefficient(g), (E2QuadApprox.coefficient(tau)/2).coefficient(theta_1), (E2QuadApprox.coefficient(tau)/2).coefficient(theta_2)], [ (E2QuadApprox.coefficient(T)/2).coefficient(g), (E2QuadApprox.coefficient(T)/2).coefficient(theta_1), (E2QuadApprox.coefficient(T)/2).coefficient(theta_2)], [ (E2QuadApprox.coefficient(l1)/2).coefficient(g), (E2QuadApprox.coefficient(l1)/2).coefficient(theta_1), (E2QuadApprox.coefficient(l1)/2).coefficient(theta_2)], [ (E2QuadApprox.coefficient(l2)/2).coefficient(g), (E2QuadApprox.coefficient(l2)/2).coefficient(theta_1), (E2QuadApprox.coefficient(l2)/2).coefficient(theta_2)], [ (E2QuadApprox.coefficient(b)/2).coefficient(g), (E2QuadApprox.coefficient(b)/2).coefficient(theta_1), (E2QuadApprox.coefficient(b)/2).coefficient(theta_2)] ]) 
E2Dycheckxi= matrix([[ (E2QuadApprox.coefficient(tau_)/2).coefficient(g), (E2QuadApprox.coefficient(tau_)/2).coefficient(theta_1), (E2QuadApprox.coefficient(tau_)/2).coefficient(theta_2)], [ (E2QuadApprox.coefficient(T_)/2).coefficient(g), (E2QuadApprox.coefficient(T_)/2).coefficient(theta_1), (E2QuadApprox.coefficient(T_)/2).coefficient(theta_2)], [ (E2QuadApprox.coefficient(l1_)/2).coefficient(g), (E2QuadApprox.coefficient(l1_)/2).coefficient(theta_1), (E2QuadApprox.coefficient(l1_)/2).coefficient(theta_2)], [ (E2QuadApprox.coefficient(l2_)/2).coefficient(g), (E2QuadApprox.coefficient(l2_)/2).coefficient(theta_1), (E2QuadApprox.coefficient(l2_)/2).coefficient(theta_2)], [ (E2QuadApprox.coefficient(b_)/2).coefficient(g), (E2QuadApprox.coefficient(b_)/2).coefficient(theta_1), (E2QuadApprox.coefficient(b_)/2).coefficient(theta_2)] ]) 
E2Dxixi = matrix([[ E2QuadApprox.coefficient(g^2), (E2QuadApprox.coefficient(g)/2).coefficient(theta_1), (E2QuadApprox.coefficient(g)/2).coefficient(theta_2)], [ (E2QuadApprox.coefficient(theta_1)/2).coefficient(g), E2QuadApprox.coefficient(theta_1^2), (E2QuadApprox.coefficient(theta_1)/2).coefficient(theta_2)], [ (E2QuadApprox.coefficient(theta_2)/2).coefficient(g), (E2QuadApprox.coefficient(theta_2)/2).coefficient(theta_1), E2QuadApprox.coefficient(theta_2^2)] ]) 


var ('ss_lambda_O')
O=alpha_1*(((ss_theta_1*exp(theta_1))^(1/sigma) *(1-ss_tau*exp(tau))^(1/sigma)*(ss_l1*exp(l1))^(-gamma/sigma))^(1-sigma)/(1-sigma)- (l1)^(1+gamma)/(1+gamma) )+ alpha_2*( ((ss_theta_2*exp(theta_2))^(1/sigma) *(1-ss_tau*exp(tau))^(1/sigma)*(ss_l2*exp(l2))^(-gamma/sigma))^(1-sigma)/(1-sigma)- (l2)^(1+gamma)/(1+gamma) )
OLinearApprox= simplify((taylor(O,(tau_,0),(T_,0),(l1_,0),(l2_,0),(b_,0),(tau,0),(T,0),(l1,0),(l2,0),(b,0),(tau,0),(T,0),(l1,0),1)))
OQuadApprox== simplify((taylor(O,(tau_,0),(T_,0),(l1_,0),(l2_,0),(b_,0),(tau,0),(T,0),(l1,0),(l2,0),(b,0),(tau,0),(T,0),(l1,0),2)))-OLinearApprox
# Linear Terms
ODy = vector([ OLinearApprox.coefficient(tau) , OLinearApprox.coefficient(T) , OLinearApprox.coefficient(l1) , OLinearApprox.coefficient(l2) , OLinearApprox.coefficient(b)])
ODycheck = vector([ OLinearApprox.coefficient(tau_) , OLinearApprox.coefficient(T_) , OLinearApprox.coefficient(l1_) , OLinearApprox.coefficient(l2_) , OLinearApprox.coefficient(b_)])
ODxi = vector([ OLinearApprox.coefficient(g) , OLinearApprox.coefficient(theta_1) , OLinearApprox.coefficient(theta_2)])
# Quadratic Terms
ODyy = matrix([[ OQuadApprox.coefficient(tau^2), (OQuadApprox.coefficient(tau)/2).coefficient(T), (OQuadApprox.coefficient(tau)/2).coefficient(l1), (OQuadApprox.coefficient(tau)/2).coefficient(l2), (OQuadApprox.coefficient(tau)/2).coefficient(b)], [ (OQuadApprox.coefficient(T)/2).coefficient(tau), OQuadApprox.coefficient(T^2), (OQuadApprox.coefficient(T)/2).coefficient(l1), (OQuadApprox.coefficient(T)/2).coefficient(l2), (OQuadApprox.coefficient(T)/2).coefficient(b)], [ (OQuadApprox.coefficient(l1)/2).coefficient(tau), (OQuadApprox.coefficient(l1)/2).coefficient(T), OQuadApprox.coefficient(l1^2), (OQuadApprox.coefficient(l1)/2).coefficient(l2), (OQuadApprox.coefficient(l1)/2).coefficient(b)], [ (OQuadApprox.coefficient(l2)/2).coefficient(tau), (OQuadApprox.coefficient(l2)/2).coefficient(T), (OQuadApprox.coefficient(l2)/2).coefficient(l1), OQuadApprox.coefficient(l2^2), (OQuadApprox.coefficient(l2)/2).coefficient(b)], [ (OQuadApprox.coefficient(b)/2).coefficient(tau), (OQuadApprox.coefficient(b)/2).coefficient(T), (OQuadApprox.coefficient(b)/2).coefficient(l1), (OQuadApprox.coefficient(b)/2).coefficient(l2), OQuadApprox.coefficient(b^2)] ]) 
ODycheckycheck = matrix([[ OQuadApprox.coefficient(tau_^2), (OQuadApprox.coefficient(tau_)/2).coefficient(T_), (OQuadApprox.coefficient(tau_)/2).coefficient(l1_), (OQuadApprox.coefficient(tau_)/2).coefficient(l2_), (OQuadApprox.coefficient(tau_)/2).coefficient(b_)], [ (OQuadApprox.coefficient(T_)/2).coefficient(tau_), OQuadApprox.coefficient(T_^2), (OQuadApprox.coefficient(T_)/2).coefficient(l1_), (OQuadApprox.coefficient(T_)/2).coefficient(l2_), (OQuadApprox.coefficient(T_)/2).coefficient(b_)], [ (OQuadApprox.coefficient(l1_)/2).coefficient(tau_), (OQuadApprox.coefficient(l1_)/2).coefficient(T_), OQuadApprox.coefficient(l1_^2), (OQuadApprox.coefficient(l1_)/2).coefficient(l2_), (OQuadApprox.coefficient(l1_)/2).coefficient(b_)], [ (OQuadApprox.coefficient(l2_)/2).coefficient(tau_), (OQuadApprox.coefficient(l2_)/2).coefficient(T_), (OQuadApprox.coefficient(l2_)/2).coefficient(l1_), OQuadApprox.coefficient(l2_^2), (OQuadApprox.coefficient(l2_)/2).coefficient(b_)], [ (OQuadApprox.coefficient(b_)/2).coefficient(tau_), (OQuadApprox.coefficient(b_)/2).coefficient(T_), (OQuadApprox.coefficient(b_)/2).coefficient(l1_), (OQuadApprox.coefficient(b_)/2).coefficient(l2_), OQuadApprox.coefficient(b_^2)] ]) 
ODyycheck = matrix([[ (OQuadApprox.coefficient(tau)/2).coefficient(tau_), (OQuadApprox.coefficient(tau)/2).coefficient(T_), (OQuadApprox.coefficient(tau)/2).coefficient(l1_), (OQuadApprox.coefficient(tau)/2).coefficient(l2_), (OQuadApprox.coefficient(tau)/2).coefficient(b_)], [ (OQuadApprox.coefficient(T)/2).coefficient(tau_), (OQuadApprox.coefficient(T)/2).coefficient(T_), (OQuadApprox.coefficient(T)/2).coefficient(l1_), (OQuadApprox.coefficient(T)/2).coefficient(l2_), (OQuadApprox.coefficient(T)/2).coefficient(b_)], [ (OQuadApprox.coefficient(l1)/2).coefficient(tau_), (OQuadApprox.coefficient(l1)/2).coefficient(T_), (OQuadApprox.coefficient(l1)/2).coefficient(l1_), (OQuadApprox.coefficient(l1)/2).coefficient(l2_), (OQuadApprox.coefficient(l1)/2).coefficient(b_)], [ (OQuadApprox.coefficient(l2)/2).coefficient(tau_), (OQuadApprox.coefficient(l2)/2).coefficient(T_), (OQuadApprox.coefficient(l2)/2).coefficient(l1_), (OQuadApprox.coefficient(l2)/2).coefficient(l2_), (OQuadApprox.coefficient(l2)/2).coefficient(b_)], [ (OQuadApprox.coefficient(b)/2).coefficient(tau_), (OQuadApprox.coefficient(b)/2).coefficient(T_), (OQuadApprox.coefficient(b)/2).coefficient(l1_), (OQuadApprox.coefficient(b)/2).coefficient(l2_), (OQuadApprox.coefficient(b)/2).coefficient(b_)] ]) 
ODyxi = matrix([[ (OQuadApprox.coefficient(tau)/2).coefficient(g), (OQuadApprox.coefficient(tau)/2).coefficient(theta_1), (OQuadApprox.coefficient(tau)/2).coefficient(theta_2)], [ (OQuadApprox.coefficient(T)/2).coefficient(g), (OQuadApprox.coefficient(T)/2).coefficient(theta_1), (OQuadApprox.coefficient(T)/2).coefficient(theta_2)], [ (OQuadApprox.coefficient(l1)/2).coefficient(g), (OQuadApprox.coefficient(l1)/2).coefficient(theta_1), (OQuadApprox.coefficient(l1)/2).coefficient(theta_2)], [ (OQuadApprox.coefficient(l2)/2).coefficient(g), (OQuadApprox.coefficient(l2)/2).coefficient(theta_1), (OQuadApprox.coefficient(l2)/2).coefficient(theta_2)], [ (OQuadApprox.coefficient(b)/2).coefficient(g), (OQuadApprox.coefficient(b)/2).coefficient(theta_1), (OQuadApprox.coefficient(b)/2).coefficient(theta_2)] ]) 
ODycheckxi= matrix([[ (OQuadApprox.coefficient(tau_)/2).coefficient(g), (OQuadApprox.coefficient(tau_)/2).coefficient(theta_1), (OQuadApprox.coefficient(tau_)/2).coefficient(theta_2)], [ (OQuadApprox.coefficient(T_)/2).coefficient(g), (OQuadApprox.coefficient(T_)/2).coefficient(theta_1), (OQuadApprox.coefficient(T_)/2).coefficient(theta_2)], [ (OQuadApprox.coefficient(l1_)/2).coefficient(g), (OQuadApprox.coefficient(l1_)/2).coefficient(theta_1), (OQuadApprox.coefficient(l1_)/2).coefficient(theta_2)], [ (OQuadApprox.coefficient(l2_)/2).coefficient(g), (OQuadApprox.coefficient(l2_)/2).coefficient(theta_1), (OQuadApprox.coefficient(l2_)/2).coefficient(theta_2)], [ (OQuadApprox.coefficient(b_)/2).coefficient(g), (OQuadApprox.coefficient(b_)/2).coefficient(theta_1), (OQuadApprox.coefficient(b_)/2).coefficient(theta_2)] ]) 
ODxixi = matrix([[ OQuadApprox.coefficient(g^2), (OQuadApprox.coefficient(g)/2).coefficient(theta_1), (OQuadApprox.coefficient(g)/2).coefficient(theta_2)], [ (OQuadApprox.coefficient(theta_1)/2).coefficient(g), OQuadApprox.coefficient(theta_1^2), (OQuadApprox.coefficient(theta_1)/2).coefficient(theta_2)], [ (OQuadApprox.coefficient(theta_2)/2).coefficient(g), (OQuadApprox.coefficient(theta_2)/2).coefficient(theta_1), OQuadApprox.coefficient(theta_2^2)] ]) 

